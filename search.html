---
layout: default
title: Search
permalink: /search/
---

<h1>Search</h1>

<input id="search-input" type="text" placeholder="Type to search..." aria-label="Search">
<ul id="results"></ul>

<script src="https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', async () => {
  // Fetch prebuilt index
  const res = await fetch('{{ "/search.json" | relative_url }}');
  if (!res.ok) { console.error("Cannot load search.json"); return; }
  const docs = await res.json();

  // Build Lunr index
  const idx = lunr(function () {
    this.ref("url");
    this.field("title");
    this.field("content");
    docs.forEach(doc => this.add(doc));
  });

  const input = document.getElementById('search-input');
  const resultsList = document.getElementById('results');

  input.addEventListener('input', () => {
    const query = input.value.trim();
    resultsList.innerHTML = "";
    if (query.length < 2) return; // only search 2+ characters

    const results = idx.search(query);
    if (results.length === 0) {
      resultsList.innerHTML = "<li>No results found</li>";
      return;
    }

    results.forEach(result => {
      const doc = docs.find(d => d.url === result.ref);
      const li = document.createElement("li");
      li.innerHTML = `<a href="${doc.url}">${doc.title}</a>`;
      resultsList.appendChild(li);
    });
  });
});
</script>
